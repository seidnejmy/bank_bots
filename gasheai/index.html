<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #F2DBE1;
            color: #333;
            line-height: 1.6;
            display: flex;
            transition: background-color 0.3s, color 0.3s;
        }

        .dark-mode {
            background-color: #333;
            color: #f2f2f2;
        }

        #sidebar {
            width: 250px;
            background-color: #7D0B8E;
            padding: 20px;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.5);
            transition: background-color 0.3s;
        }

        .dark-mode #sidebar {
            background-color: #444;
        }

        #back-button {
            background-color: transparent;
            border: none;
            color: #fff;
            font-size: 16px;
            cursor: pointer;
            margin-bottom: 15px;
        }

        #sidebar img {
            width: 100%;
            border-radius: 10px;
            margin-bottom: 15px;
        }

        #sidebar h2, #sidebar p {
            color: #fff;
        }

        .dark-mode #sidebar h2, .dark-mode #sidebar p {
            color: #f2f2f2;
        }

        #main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        #header {
            background-color: #9118AC;
            color: #fff;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
            transition: background-color 0.3s;
        }

        .dark-mode #header {
            background-color: #444;
        }

        #header h1 {
            margin: 0;
            font-size: 1.8rem;
        }

        #header-buttons button {
            margin-left: 15px;
            background-color: #fff;
            color: #d45732;
            border: none;
            padding: 10px 18px;
            cursor: pointer;
            border-radius: 5px;
            font-size: 14px;
            transition: background-color 0.3s ease;
        }

        .dark-mode #header-buttons button {
            background-color: #555;
            color: #fff;
        }

        #chat-container {
            display: flex;
            flex-direction: column;
            height: calc(100vh - 230px);
            padding: 20px;
            overflow-y: auto;
            background-color: #fff;
            border-top: 1px solid #d45732;
            transition: background-color 0.3s, color 0.3s;
        }

        .dark-mode #chat-container {
            background-color: #222;
            color: #f2f2f2;
        }

        .message {
            margin: 10px 0;
            padding: 12px 15px;
            border-radius: 12px;
            max-width: 70%;
        }

        .message.user {
            align-self: flex-end;
            text-align: right;
            background-color: #ff8c00;
            color: #fff;
        }

        .message.bot {
            align-self: flex-start;
            text-align: left;
            background-color: #d45732;
            color: #fff;
        }

        .dark-mode .message.user {
            background-color: #888;
        }

        .dark-mode .message.bot {
            background-color: #555;
        }

        #input-area {
            position: fixed;
            bottom: 0;
            width: 100%;
            padding: 15px 20px;
            background-color: #fff;
            border-top: 1px solid #d45732;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: background-color 0.3s;
        }

        .dark-mode #input-area {
            background-color: #444;
        }

        #message-input {
            flex: 1;
            padding: 12px 15px;
            font-size: 14px;
            border: 1px solid #d45732;
            border-radius: 5px;
            outline: none;
            transition: border-color 0.3s ease;
            background-color: #f2f2f2;
            color: #333;
        }

        .dark-mode #message-input {
            background-color: #666;
            color: #f2f2f2;
            border-color: #888;
        }

        #send-button {
            background-color: #ff8c00;
            color: #fff;
            border: none;
            padding: 10px 18px;
            font-size: 14px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .dark-mode #send-button {
            background-color: #555;
        }

        #language-buttons {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            padding: 10px;
            background-color: #f2f2f2;
            position: fixed;
            bottom: 60px;
            width: 100%;
            z-index: 10;
        }

        .dark-mode #language-buttons {
            background-color: #444;
        }

        #language-buttons button {
            padding: 8px 12px;
            border: 1px solid #d45732;
            cursor: pointer;
            background-color: #fff;
            color: #d45732;
            border-radius: 5px;
            font-size: 14px;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .dark-mode #language-buttons button {
            background-color: #555;
            color: #f2f2f2;
        }

        #language-buttons button.active {
            background-color: #d45732;
            color: white;
            border-color: #d45732;
        }

        .dark-mode #language-buttons button.active {
            background-color: #888;
        }

        @media (max-width: 768px) {
            #sidebar {
                display: none;
            }

            #main-content {
                width: 100%;
            }

            #chat-container {
                height: calc(100vh - 180px);
            }
        }
    </style>
</head>
<body>
    <div id="sidebar">
        <a href="https://gasheai.nehabi.com/">
            <button id="back-button">Back</button>
        </a>
        <img src="https://gasheai.nehabi.com/extensions/uploads/sites/561/2024/11/retina-logopng-1.png" alt="Placeholder Photo">
        <h2>GasheAI</h2>
        <p>Explore the art of cooking with our expert guidance and delicious recipes.</p>
    </div>
    <div id="main-content">
        <div id="header">
            <h1>Chat with GasheAI</h1>
            <div id="header-buttons">
                <button id="new-chat-button">New Chat</button>
                <button id="dark-mode-toggle">Enable Dark Mode</button>
            </div>
        </div>
        <div id="chat-container"></div>
        <div id="language-buttons">
            <button id="en-button" class="active">English</button>
            <button id="am-button">Amharic</button>
            <button id="om-button">Oromo</button>
            <button id="so-button">Somali</button>
            <button id="ti-button">Tigrigna</button>
            <button id="aa-button">Afar</button>
        </div>
        <div id="input-area">
            <input type="text" id="message-input" placeholder="Type your message here...">
            <button id="send-button">Send</button>
        </div>
    </div>
</body>

</html>

<script>
    const chatContainer = document.getElementById('chat-container');
    const messageInput = document.getElementById('message-input');
    const sendButton = document.getElementById('send-button');
    const languageButtons = document.getElementById('language-buttons');
    const darkModeToggle = document.getElementById('dark-mode-toggle');
    const newChatButton = document.getElementById('new-chat-button');
    let currentLanguage = 'en';
    let isDarkMode = false;

    const API_KEY = "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"; // Replace with your actual API key
    const MODEL = "llama3-groq-70b-8192-tool-use-preview";
    const TRANSLATION_API_URL = "https://translate.googleapis.com/translate_a/single";

    let chatHistory = []; // Store the chat history here

    // Toggle Dark Mode
    darkModeToggle.addEventListener('click', () => {
        document.body.classList.toggle('dark-mode');
        isDarkMode = !isDarkMode;
        darkModeToggle.textContent = isDarkMode ? 'Disable Dark Mode' : 'Enable Dark Mode';
    });

    // New Chat
    newChatButton.addEventListener('click', () => {
        chatContainer.innerHTML = '';
        messageInput.value = '';
        chatHistory = []; // Reset chat history
    });

    // Language selection
    languageButtons.addEventListener('click', (e) => {
        if (e.target.tagName === 'BUTTON') {
            currentLanguage = e.target.id.split('-')[0];
            document.querySelectorAll('#language-buttons button').forEach(btn => btn.classList.remove('active'));
            e.target.classList.add('active');
        }
    });

// Translate text using Google Translate API
async function translateText(text, targetLang) {
    if (targetLang === 'en') return text; // Skip translation if the target language is English

    const url = `${TRANSLATION_API_URL}?client=gtx&sl=auto&tl=${targetLang}&dt=t&q=${encodeURIComponent(text)}`;
    try {
        const response = await fetch(url);
        if (!response.ok) throw new Error('Translation API error: ' + response.statusText);

        const data = await response.json();
        
        // Combine all parts of the translated response
        // Ensure full translation is returned without splitting by punctuation
        return data[0].map(part => part[0]).join(''); 
    } catch (error) {
        console.error('Translation error:', error);
        return text; // Return the original text if translation fails
    }
}

    // Send message
    sendButton.addEventListener('click', async () => {
        const userMessage = messageInput.value.trim();
        if (!userMessage) return;

        // Display user message
        chatContainer.innerHTML += `<div class="message user">${userMessage}</div>`;
        chatContainer.scrollTop = chatContainer.scrollHeight;
        messageInput.value = '';

        // Translate user message to English
        const translatedMessage = await translateText(userMessage, 'en');

        // Add user message to chat history
        chatHistory.push({ role: "user", content: translatedMessage });

        // Send chat history to AI
        try {
            const response = await fetch("https://api.groq.com/openai/v1/chat/completions", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": `Bearer ${API_KEY}`
                },
                body: JSON.stringify({
                    model: MODEL,
                    messages: [
                        { role: "system", content: "You are Gashe, my personal assistant. You provide helpful, friendly, and concise responses to any query." },
                        ...chatHistory // Include full chat history
                    ]
                })
            });

            if (!response.ok) {
                throw new Error('Network response was not ok: ' + response.statusText);
            }

            const data = await response.json();
            let aiResponse = data.choices[0].message.content;

            // Translate AI response to the current language
            aiResponse = await translateText(aiResponse, currentLanguage);

            // Display AI response
            chatContainer.innerHTML += `<div class="message bot">Gashe: ${aiResponse}</div>`;
            chatContainer.scrollTop = chatContainer.scrollHeight;

            // Add bot response to chat history
            chatHistory.push({ role: "assistant", content: aiResponse });

        } catch (error) {
            console.error('Error sending message:', error);
            chatContainer.innerHTML += `<div class="message bot">Error: ${error.message}</div>`;
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }
    });

    // Allow "Enter" to send the message
    messageInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') sendButton.click();
    });
</script>


</body>
</html>
